webpackJsonp([0],[,,,,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){t||(t=window.location.href),e=e.replace(/[[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}var r=n(1),a=i(r),s=n(6),u=i(s),c=n(7),l=i(c),d=n(9),v=i(d),h=n(10),f=i(h),m=n(11),p=i(m),y=n(12),g=i(y);document.addEventListener("DOMContentLoaded",function(){if(a.default){var e=window.innerWidth,t=window.innerHeight,n=document.getElementById("container"),i=new v.default({width:e,height:t,container:n}),r=new p.default,s=new u.default({aspectRatio:1,position:{x:0,y:0,z:-1.5}}),c=new l.default({minDistance:0,maxDistance:1700,camera:s.get(),rendererDomElement:i.getDomElement()}),d=new f.default,h=new g.default({numParticles:1e5,scene:r,renderer:i}),m=function(){s.update(),d.update(),h.update(),i.render({scene:r.get(),camera:s.get()})};!function(){c.onChange(m),"true"===o("stats")&&n.appendChild(d.getDomElement())}(),function e(){requestAnimationFrame(e),c.update(),m()}()}else{document.getElementById("info").innerHTML="Your browser is not supported. Please use the latest version of Firefox or Chrome."}})},function(e,t,n){"use strict";(function(e){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function t(i){var o=i.fov,r=void 0===o?45:o,a=i.aspectRatio,s=void 0===a?window.innerHeight/window.innerWidth:a,u=i.near,c=void 0===u?.01:u,l=i.far,d=void 0===l?500:l,v=i.position,h=void 0===v?{x:0,y:0,z:0}:v;i.up;n(this,t),this.camera=new e.PerspectiveCamera(r,s,c,d),this.setPosition(h),window.addEventListener("resize",this.onWindowResize.bind(this))}return i(t,[{key:"onWindowResize",value:function(){var e=window.innerWidth,t=window.innerHeight;this.camera.aspect=e/t,this.camera.updateProjectionMatrix()}},{key:"setUp",value:function(e,t,n){this.camera.up.set(e,t,n)}},{key:"setPosition",value:function(e){var t=e.x,n=void 0===t?this.camera.position.x:t,i=e.y,o=void 0===i?this.camera.position.y:i,r=e.z,a=void 0===r?this.camera.position.z:r;this.setX(n),this.setY(o),this.setZ(a)}},{key:"setX",value:function(e){this.camera.position.x=e}},{key:"setY",value:function(e){this.camera.position.y=e}},{key:"setZ",value:function(e){this.camera.position.z=e}},{key:"update",value:function(){}},{key:"get",value:function(){return this.camera}}]),t}();t.default=o}).call(t,n(0))},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(2),a=function(e){return e&&e.__esModule?e:{default:e}}(r),s=function(){function e(t){var n=t.camera,o=t.rendererDomElement,r=void 0===o?null:o,s=t.rotateSpeed,u=void 0===s?1:s,c=t.zoomSpeed,l=void 0===c?1:c,d=t.panSpeed,v=void 0===d?1:d,h=t.noPan,f=void 0!==h&&h,m=t.staticMoving,p=void 0===m||m,y=t.dynamicDampingFactor,g=void 0===y?0:y,w=t.minDistance,x=void 0===w?0:w,z=t.maxDistance,P=void 0===z?1/0:z,S=t.keys,b=void 0===S?[65,83,68]:S;i(this,e),this.controls=new a.default(n,r),this.controls.rotateSpeed=u,this.controls.zoomSpeed=l,this.controls.panSpeed=v,this.controls.noPan=f,this.controls.staticMoving=p,this.controls.dynamicDampingFactor=g,this.controls.minDistance=x,this.controls.maxDistance=P,this.controls.keys=b}return o(e,[{key:"onChange",value:function(e){this.controls.addEventListener("change",e)}},{key:"update",value:function(){this.controls.update()}}]),e}();t.default=s},,function(e,t,n){"use strict";(function(e){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function t(i){var o=i.alpha,r=void 0===o||o,a=i.pixelRatio,s=void 0===a?window.devicePixelRatio:a,u=i.width,c=void 0===u?window.width:u,l=i.height,d=void 0===l?window.height:l,v=i.container;n(this,t),this.renderer=new e.WebGLRenderer({alpha:r});var h=this.renderer.context;h.enable(h.BLEND),h.blendFunc(h.SRC_ALPHA,h.ONE_MINUS_SRC_ALPHA),this.setPixelRatio(s),this.setSize(c,d),v.appendChild(this.getDomElement()),window.addEventListener("resize",this.onWindowResize.bind(this))}return i(t,[{key:"getDomElement",value:function(e){return this.renderer.domElement}},{key:"onWindowResize",value:function(){var e=window.innerWidth,t=window.innerHeight;this.renderer.setSize(e,t)}},{key:"setPixelRatio",value:function(e){this.renderer.setPixelRatio(e)}},{key:"setSize",value:function(e,t){this.renderer.setSize(e,t)}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scene,n=e.camera,i=e.renderTarget,o=void 0===i?null:i,r=e.force,a=void 0!==r&&r;this.renderer.render(t,n,o,a)}},{key:"get",value:function(){return this.renderer}}]),t}();t.default=o}).call(t,n(0))},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(3),a=function(e){return e&&e.__esModule?e:{default:e}}(r),s=function(){function e(){i(this,e),this.stats=new a.default}return o(e,[{key:"getDomElement",value:function(e){return this.stats.domElement}},{key:"update",value:function(){this.stats.update()}}]),e}();t.default=s},function(e,t,n){"use strict";(function(e){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function t(){n(this,t),this.scene=new e.Scene,this.scene.background=new e.Color(16777215)}return i(t,[{key:"add",value:function(e){this.scene.add(e)}},{key:"remove",value:function(e){this.scene.remove(e)}},{key:"get",value:function(){return this.scene}}]),t}();t.default=o}).call(t,n(0))},function(e,t,n){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(4),a=function(e){return e&&e.__esModule?e:{default:e}}(r),s=n(14),u=n(15),c=function(){function t(n){var o=this,r=n.scene,a=n.numParticles,s=void 0===a?1e5:a,u=n.uniforms,c=void 0===u?{sizeMultipler:{value:window.innerHeight*window.devicePixelRatio/2},color:{value:new e.Color(16777215)}}:u,l=n.blending,d=(void 0===l&&e.AdditiveBlending,n.transparent,n.depthTest,n.depthWrite,n.renderer),v=n.particleSize,h=void 0===v?.06:v,f=n.particleSizeInc,m=void 0===f?5e-5:f,p=n.zInc,y=void 0===p?3e-4:p,g=n.yInc,w=void 0===g?7e-4:g,x=n.yThreshold,z=void 0===x?.2:x;i(this,t),this.scene=r,this.numParticles=s,this.renderer=d,this.uniforms=c,this.particleSize=h,this.particleSizeInc=m,this.zInc=y,this.yInc=w,this.yThreshold=z,this.windowHalfX=window.innerWidth/2,this.windowHalfY=window.innerHeight/2,this.video=document.createElement("video");var P=document.createElement("h1");P.innerHTML="Your browser is not supported. Please use Google Chrome (v21 or above).",navigator.getUserMedia?navigator.getUserMedia({video:{width:1280,height:720}},function(e){var t=o.video;t.src=URL.createObjectURL(e),t.width=480,t.height=480,o.addParticles()},function(){return console.error("video failed to load")}):document.getElementsByTagName("body")[0].append(P)}return o(t,[{key:"onDocumentMouseMove",value:function(e){this.mouseX=this.windowHalfX-e.clientX,this.mouseY=e.clientY-this.windowHalfY,this.FBO.simulationShader.uniforms.mouse.value.set(.5*this.mouseX/this.windowHalfX,-.5*this.mouseY/this.windowHalfY,0)}},{key:"addParticles",value:function(){for(var t=this.video,n=this.renderer,i=this.numParticles,o=t.width/t.height,r=o>1?o:1,c=o>1?1:t.height/t.width,l=r,d=c;l*d<i-r*c;)l+=r,d+=c;var v=Math.ceil(l),h=Math.ceil(d);this.numParticles=v*h,this.FBO=new a.default({tWidth:v,tHeight:h,renderer:n.get(),uniforms:{tWidth:{type:"f",value:v},tHeight:{type:"f",value:h},mouse:{value:new e.Vector3(1e4,1e4,1e4)},tSize:{type:"t",value:0},yThreshold:{type:"f",value:this.yThreshold}},simulationVertexShader:s.simulationVertexShader,simulationFragmentShader:s.simulationFragmentShader}),this.FBO.setTextureUniform("tSize",this.getSizes());var f=this.videoImage=document.createElement("canvas");this.videoImageContext=f.getContext("2d");var m=this.videoTexture=new e.Texture(f);m.minFilter=m.magFilter=e.NearestFilter,m.needsUpdate=!0;for(var p=this.material=new e.ShaderMaterial({blending:e.NormalBlending,uniforms:Object.assign({},this.uniforms,{tTexture:{type:"t",value:m},tFrame:{type:"t",value:this.FBO.targets[0]}}),fragmentShader:u.fragmentShader,vertexShader:u.vertexShader,opacity:1,vertexColors:!0,transparent:!0}),y=this.geometry=new e.Geometry,g=0;g<this.numParticles;g++){var w=new e.Vector3;w.x=g%v/v,w.y=Math.floor(g/v)/h,y.vertices.push(w)}this.particles=new e.Points(y,p),this.particles.frustumCulled=!1,this.scene.add(this.get()),console.log("scene loaded!","Expected: "+this.numParticles+" particles","Actual: "+y.vertices.length+" particles","Cols: "+v,"Rows: "+h),this.ready=!0,document.addEventListener("mousemove",this.onDocumentMouseMove.bind(this),!1)}},{key:"getSizes",value:function(){for(var e=new Float32Array(4*this.numParticles),t=0,n=0;t<this.numParticles;t++,n+=4)e[n]=this.zInc*Math.random(),e[n+1]=this.yInc*(Math.random()/2+.5),e[n+2]=this.calcSize(),e[n+3]=this.particleSizeInc*Math.random();return e}},{key:"calcSize",value:function(){return this.particleSize*Math.random()}},{key:"update",value:function(){if(this.ready){var e=this.video,t=this.videoImageContext,n=this.videoImage,i=n.width,o=n.height,r=this.videoTexture;e.readyState===e.HAVE_ENOUGH_DATA&&(t.drawImage(e,0,0,i,o),r.needsUpdate=!0),this.FBO.simulate(),this.material.uniforms.tFrame.value=this.FBO.getCurrentFrame()}}},{key:"get",value:function(){return this.particles}}]),t}();t.default=c}).call(t,n(0))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.simulationFragmentShader="\n\t/** generates a random number between 0 and 1 **/\n\thighp float rand(vec2 co)\n\t{\n\t\thighp float a = 12.9898;\n\t\thighp float b = 78.233;\n\t\thighp float c = 43758.5453;\n\t\thighp float dt= dot(co.xy ,vec2(a,b));\n\t\thighp float sn= mod(dt,3.14);\n\t\treturn fract(sin(sn) * c);\n\t}\n\n\tvarying vec2 vUv;\n\n\tuniform sampler2D tPrev;\n\tuniform sampler2D tCurr;\n\n\tuniform vec3 mouse;\n\tuniform sampler2D tSize;\n\tuniform float yThreshold;\n\n\tuniform float tWidth;\n\tuniform float tHeight;\n\n\tvec3 getPos(vec3 defaultPos) {\n\t\tvec3 prevPos = texture2D(tPrev, vUv).xyz;\n\t\tvec3 currPos = texture2D(tCurr, vUv).xyz;\n\t\tfloat xInc = texture2D(tSize, vUv).x;\n\t\tfloat yInc = texture2D(tSize, vUv).y;\n\n\t\tvec3 pos = currPos;\n\n\t\tfloat dist = length(pos - mouse);\n\n\t\tif (dist < 0.07) {\n\t\t\tpos += pos - mouse;\n\t\t} else if (pos == vec3(0.0, 0.0, 0.0) || pos.y >  yThreshold + defaultPos.y) {\n\t\t\tpos = defaultPos;\n\t\t} else {\n\t\t\tpos.y += yInc;\n\t\t\tpos.x += rand(vec2(defaultPos.x, defaultPos.y)) > 0.5 ? xInc : -xInc;\n\t\t}\n\n\t\treturn pos;\n\t}\n\n\tfloat getSize(vec3 defaultPos, vec3 pos) {\n\t\tfloat defaultSize = texture2D(tSize, vUv).z;\n\t\tfloat incSize = texture2D(tSize, vUv).w;\n\t\tfloat currSize = texture2D(tCurr, vUv).w;\n\n\t\tcurrSize += incSize;\n\n\t\tcurrSize += currSize > defaultSize + (incSize * 60.0) ? 0.0 : incSize;\n\n\t\tif (pos.y == defaultPos.y) {\n\t\t\tcurrSize = defaultSize / 2.0;\n\t\t}\n\n\t\treturn currSize;\n\t}\n\n\tvoid main() {\n\t\tvec3 defaultPos = vec3((vUv.x * 1.0) - 0.5, (vUv.y * 1.0) - 0.5, 0.0);\n\n\t\tvec3 pos = getPos(defaultPos);\n\t\tfloat size = getSize(defaultPos, pos);\n\n\t\t// write new position out\n\t\tgl_FragColor = vec4(pos, size);\n\t}\n",t.simulationVertexShader="\n\tvarying vec2 vUv;\n\n\tvoid main() {\n\t  vUv = vec2(uv);\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t}\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fragmentShader="\n\tuniform sampler2D tTexture;\n\n\tvarying vec2 vUv;\n\n\tvoid main() {\n\t\tvec3 colors = texture2D(tTexture, vUv).xyz;\n\n\t\tgl_FragColor = vec4(colors, 1.0);\n\t\tif (length(gl_PointCoord - vec2(0.5, 0.5)) > 0.475) discard;\n\t}\n",t.vertexShader="\n\tuniform sampler2D tFrame;\n\tuniform float sizeMultipler;\n\n\tvarying vec2 vUv;\n\n\tvoid main() {\n\t\tvUv = position.xy;\n\n\t\t// position saved as color value in a texture object in memory\n\t\tvec3 pos = texture2D(tFrame, vUv).xyz;\n\t\tfloat size = texture2D(tFrame, vUv).w;\n\n\t\tvec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n\t\tgl_PointSize = size * (sizeMultipler / -mvPosition.z);\n\t\tgl_Position = projectionMatrix * mvPosition;\n\t}\n"}],[5]);
//# sourceMappingURL=bundle.js.map