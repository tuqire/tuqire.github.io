webpackJsonp([0],[,,,,function(e,t,i){"use strict";(function(e){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}i.d(t,"a",function(){return c});var a=i(5),o=i.n(a),r=i(12),s=i(13),u=i(14),l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c={CIRCLE:"CIRCLE",SQUARE:"SQUARE"},d=function(){function t(i){var a=this,o=i.scene,r=i.configUniforms,s=void 0===r?{color:{value:new e.Color(16777215)},sizeMultiplierForScreen:{value:window.innerHeight*window.devicePixelRatio/2}}:r,u=i.blending,l=void 0===u?e.AdditiveBlending:u,d=i.transparent,h=void 0===d||d,v=i.depthTest,m=void 0===v||v,f=i.depthWrite,p=void 0!==f&&f,w=i.renderer,y=i.numParticles,g=void 0===y?1e4:y,b=i.mouseRadius,P=void 0===b?.05:b,x=i.mousePush,S=void 0===x?4e-4:x,z=i.particleShape,C=void 0===z?c.CIRCLE:z,k=i.defaultSize,M=void 0===k?.1:k,U=i.outlineMultiplier,E=void 0===U?.04:U,F=i.xSpeed,W=void 0===F?3e-5:F,R=i.ySpeed,T=void 0===R?6e-5:R,D=i.yThreshold,H=void 0===D?.03:D;if(n(this,t),this.renderer=w,this.numParticles=g,this.mouseRadius=P,this.mousePush=S,this.particleShape=C,this.defaultSize=M,this.outlineMultiplier=E,this.xSpeed=W,this.ySpeed=T,this.yThreshold=H,this.windowHalfX=window.innerWidth/2,this.windowHalfY=window.innerHeight/2,this.videoEl=document.createElement("video"),this.videoWidth=1280,this.videoHeight=720,navigator.getUserMedia)navigator.getUserMedia({video:{width:this.videoWidth,height:this.videoHeight}},function(e){var t=a.videoEl;t.srcObject=e,t.autoplay=!0,a.addParticles({scene:o,renderer:w,configUniforms:s,blending:l,transparent:h,depthTest:m,depthWrite:p})},function(){return console.error("video failed to load")});else{document.getElementById("info").innerHTML="Requires use of webcam. Please use the latest version of Chrome."}}return l(t,[{key:"addParticles",value:function(t){var i=t.scene,n=t.renderer,a=t.configUniforms,l=t.blending,d=t.transparent,h=t.depthTest,v=t.depthWrite,m=this.tHeight=Math.ceil(Math.sqrt(this.numParticles)),f=this.tWidth=m;this.numParticles=f*m;var p=this.webcamEl=document.createElement("canvas");this.webcamElContext=p.getContext("2d");var w=this.webcamTexture=new e.Texture(p);w.minFilter=w.magFilter=e.NearestFilter,w.needsUpdate=!0,this.webcamDifferenceFBO=new o.a({tWidth:this.webcamEl.width,tHeight:this.webcamEl.height,renderer:n.get(),uniforms:{webcamWidth:{type:"f",value:this.webcamEl.width},webcamHeight:{type:"f",value:this.webcamEl.height},tWebcam:{type:"t",value:w}},simulationVertexShader:s.b,simulationFragmentShader:s.a}),this.positionSizeFBO=new o.a({tWidth:this.webcamEl.width,tHeight:this.webcamEl.height,renderer:n.get(),uniforms:{tWebcam:{type:"t",value:0},tParams:{type:"t",value:0},mouse:{value:new e.Vector3(1e4,1e4,1e4)},mouseRadius:{type:"f",value:this.mouseRadius},mousePush:{type:"f",value:this.mousePush},yThreshold:{type:"f",value:this.yThreshold},defaultSize:{type:"f",value:this.defaultSize},outlineMultiplier:{type:"f",value:this.outlineMultiplier}},simulationVertexShader:r.b,simulationFragmentShader:r.a}),this.updateParticleParams();var y=Object.assign({},a,{isCircle:{type:"b",value:this.particleShape===c.CIRCLE},tSize:{type:"t",value:this.positionSizeFBO.targets[0]},tWebcam:{type:"t",value:0},tColour:{type:"t",value:w}});this.material=new e.ShaderMaterial({uniforms:y,vertexShader:u.b,fragmentShader:u.a,blending:l,depthTest:h,depthWrite:v,transparent:d});for(var g=new e.Geometry,b=0;b<this.numParticles;b++){var P=new e.Vector3;P.x=b%f/f,P.y=Math.floor(b/f)/m,g.vertices.push(P)}this.particles=new e.Points(g,this.material),this.particles.frustumCulled=!1,i.add(this.get()),this.ready=!0,document.addEventListener("mousemove",this.onDocumentMouseMove.bind(this),!1)}},{key:"updateParticleParams",value:function(){for(var e=new Float32Array(4*this.numParticles),t=0,i=0;t<this.numParticles;t++,i+=4){var n=this.getVelocity();e[i]=n.x,e[i+1]=n.y}this.positionSizeFBO.setTextureUniform("tParams",e)}},{key:"getVelocity",value:function(){return{x:this.xSpeed*Math.random(),y:this.ySpeed*(Math.random()/2+.5)}}},{key:"getSize",value:function(){return this.particleSize*Math.random()/2}},{key:"getSizeInc",value:function(){return this.particleSizeInc*Math.random()*2}},{key:"onDocumentMouseMove",value:function(e){this.mouseX=this.windowHalfX-e.clientX,this.mouseY=e.clientY-this.windowHalfY,this.positionSizeFBO.simulationShader.uniforms.mouse.value.set(.5*this.mouseX/this.windowHalfX,-.5*this.mouseY/this.windowHalfY,0)}},{key:"update",value:function(){if(this.ready){var e=this.videoEl,t=this.webcamElContext,i=this.webcamEl,n=i.width,a=i.height,o=this.webcamTexture;e.readyState===e.HAVE_ENOUGH_DATA&&(t.drawImage(e,0,0,n,a),o.needsUpdate=!0),this.webcamDifferenceFBO.simulate(),this.positionSizeFBO.simulationShader.uniforms.tWebcam.value=this.webcamDifferenceFBO.getCurrentFrame(),this.positionSizeFBO.simulate(),this.material.uniforms.tSize.value=this.positionSizeFBO.getCurrentFrame()}}},{key:"get",value:function(){return this.particles}},{key:"setCameraZ",value:function(e){this.cameraZ=e}},{key:"updateParticleVars",value:function(){this.positionSizeFBO.simulationShader.uniforms.mouseRadius.value=this.mouseRadius,this.positionSizeFBO.simulationShader.uniforms.mousePush.value=this.mousePush,this.positionSizeFBO.simulationShader.uniforms.yThreshold.value=this.yThreshold,this.material.uniforms.isCircle.value=this.particleShape===c.CIRCLE}},{key:"updateSizes",value:function(){this.positionSizeFBO.simulationShader.uniforms.defaultSize.value=this.defaultSize,this.positionSizeFBO.simulationShader.uniforms.outlineMultiplier.value=this.outlineMultiplier}}]),t}();t.b=d}).call(t,i(0))},,function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=i(1),o=i.n(a),r=i(2),s=i.n(r),u=i(7),l=i(3),c=i.n(l),d=i(4),h=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.particles;t.scene;n(this,e),this.gui=new c.a.GUI,this.addShapeControls(i),this.addMouseRadiusControls(i),this.addMousePushControls(i),this.addYThresholdControls(i),this.addSpeedControls(i),this.addSizeControls(i)}return h(e,[{key:"addShapeControls",value:function(e){this.gui.add(e,"particleShape",d.a).onFinishChange(function(){e.updateParticleVars()})}},{key:"addYThresholdControls",value:function(e){this.gui.add(e,"yThreshold").min(0).max(.5).step(.005).onFinishChange(function(){e.updateParticleVars()})}},{key:"addMouseRadiusControls",value:function(e){this.gui.add(e,"mouseRadius").min(0).max(.3).step(.01).onFinishChange(function(){e.updateParticleVars()})}},{key:"addMousePushControls",value:function(e){this.gui.add(e,"mousePush").min(0).max(.002).step(1e-5).onFinishChange(function(){e.updateParticleVars()})}},{key:"addSpeedControls",value:function(e){this.gui.add(e,"xSpeed").min(0).max(5e-4).step(1e-6).onFinishChange(function(){e.updateParticleParams()}),this.gui.add(e,"ySpeed").min(0).max(5e-4).step(1e-6).onFinishChange(function(){e.updateParticleParams()})}},{key:"addSizeControls",value:function(e){this.gui.add(e,"defaultSize").min(0).max(.025).step(5e-4).onFinishChange(function(){e.updateSizes()}),this.gui.add(e,"outlineMultiplier").min(0).max(1).step(.05).onFinishChange(function(){e.updateSizes()})}}]),e}(),m=v,f=i(15),p=i(16),w=function(){return window.matchMedia("(min-width: 480px)").matches},y=function(){return window.matchMedia("(max-width: 1000px)").matches};document.addEventListener("DOMContentLoaded",function(){if(o.a&&w()){var e=document.getElementById("webcam-simulation-container"),t=new f.a({container:e}),i=new p.a,n=new d.b({scene:i,renderer:t,numParticles:y()?5e4:1e5,defaultSize:.005,outlineMultiplier:.2,ySpeed:92e-6,yThreshold:.075}),a=new u.a({aspectRatio:1,particles:n,position:{x:0,y:.001,z:-1.37}}),r=new s.a,l=function(){r.begin(),n.update(),t.render({scene:i.get(),camera:a.get()}),r.end()};!function(){new m({particles:n}),r.showPanel(0),document.body.appendChild(r.dom)}(),function e(){requestAnimationFrame(e),l()}()}else{document.getElementById("info").innerHTML="This browser is not supported. Please use the latest version of Chrome on desktop."}})},function(e,t,i){"use strict";(function(e){function n(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=i(8),r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=function(){function t(i){var o=i.particles,r=i.fov,s=void 0===r?400:r,u=i.aspectRatio,l=void 0===u?window.innerWidth/window.innerHeight:u,c=i.near,d=void 0===c?.1:c,h=i.far,v=void 0===h?2e3:h,m=i.position,f=void 0===m?{x:0,y:0,z:0}:m,p=i.up,w=void 0===p?[0,0,1]:p;a(this,t),this.particles=o,this.particles.setCameraZ(f.z),this.camera=new e.PerspectiveCamera(s,l,d,v),this.up=w,this.setPosition(f),this.setUp.apply(this,n(this.up)),this.setLookAt()}return r(t,[{key:"onWindowResize",value:function(){var e=window.innerWidth,t=window.innerHeight;this.camera.aspect=e/t,this.setZ(window.innerHeight/Object(o.a)()),this.camera.updateProjectionMatrix()}},{key:"setUp",value:function(e,t,i){this.camera.up.set(e,t,i)}},{key:"setPosition",value:function(e){var t=e.x,i=void 0===t?this.camera.position.x:t,n=e.y,a=void 0===n?this.camera.position.y:n,o=e.z,r=void 0===o?this.camera.position.z:o;this.setX(i),this.setY(a),this.setZ(r)}},{key:"setX",value:function(e){this.camera.position.x=e,this.setLookAt()}},{key:"setY",value:function(e){this.camera.position.y=e,this.setLookAt()}},{key:"setZ",value:function(e){this.camera.position.z=e,this.setLookAt(),this.setUp(0,0,1),this.particles.setCameraZ(e)}},{key:"setLookAt",value:function(){this.camera.lookAt(new e.Vector3(0,0,0))}},{key:"get",value:function(){return this.camera}},{key:"getPosition",value:function(){return this.camera.position}},{key:"getZ",value:function(){return this.camera.position.z}}]),t}();t.a=s}).call(t,i(0))},function(e,t,i){"use strict";(function(e){function i(){return window.innerWidth>1100?170:window.innerWidth>700?100:window.innerWidth>500?85:50}t.a=i}).call(t,i(0))},,,,function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i.d(t,"b",function(){return a});var n="\n\t/** generates a random number between 0 and 1 **/\n\thighp float rand(vec2 co) {\n\t\thighp float a = 12.9898;\n\t\thighp float b = 78.233;\n\t\thighp float c = 43758.5453;\n\t\thighp float dt= dot(co.xy ,vec2(a,b));\n\t\thighp float sn= mod(dt,3.14);\n\t\treturn fract(sin(sn) * c);\n\t}\n\n\t// this is the texture position the data for this particle is stored in\n\tvarying vec2 vUv;\n\n\tuniform sampler2D tWebcam;\n\tuniform sampler2D tPrev;\n\tuniform sampler2D tCurr;\n\n\tuniform vec3 mouse;\n\tuniform sampler2D tParams;\n\tuniform float yThreshold;\n\tuniform float mouseRadius;\n\tuniform float mousePush;\n\n\tuniform float defaultSize;\n\tuniform float outlineMultiplier;\n\n\tvec3 getPos() {\n\t\tvec3 defaultPos = vec3((vUv.x * 1.0) - 0.5, (vUv.y * 1.0) - 0.5, 0.0);\n\t\tvec3 deacceleration = vec3(1.1);\n\t\tvec3 prevPos = texture2D(tPrev, vUv).xyz;\n\t\tvec3 currPos = texture2D(tCurr, vUv).xyz;\n\t\tvec3 velocity = currPos == defaultPos ? vec3(0.0) : (currPos - prevPos) / deacceleration;\n\t\tvec3 pos = currPos;\n\t\tfloat distanceToMouse = length(pos - mouse);\n\n\t\tif (distanceToMouse < mouseRadius) {\n\t\t\tvelocity += (normalize(pos - mouse) * mousePush);\n\t\t}\n\n\t\tfloat xSpeed = texture2D(tParams, vUv).x;\n\t\tfloat ySpeed = texture2D(tParams, vUv).y;\n\t\tvelocity.y += ySpeed;\n\t\tvelocity.x += rand(vec2(defaultPos.x, defaultPos.y)) > 0.5 ? xSpeed : -xSpeed;\n\n\t\tif (pos == vec3(0.0) || pos.y > yThreshold + defaultPos.y) {\n\t\t\tpos = defaultPos;\n\t\t} else {\n\t\t\tpos += velocity;\n\t\t}\n\n\t\treturn pos;\n\t}\n\n\tfloat getSize() {\n\t\tvec2 defaultPixel = vec2((vUv.x * 1.0), (vUv.y * 1.0));\n\t\tfloat webcamParticleVal = texture2D(tWebcam, vec2(defaultPixel.x, defaultPixel.y)).r;\n\t\tfloat size = defaultSize + (outlineMultiplier * webcamParticleVal);\n\n\t\treturn size;\n\t}\n\n\tvoid main() {\n\t\tgl_FragColor = vec4(getPos(), getSize());\n\t}\n",a="\n\t// this value stores the texture coordinates the data for this vertex is stored in\n\tvarying vec2 vUv;\n\n\tvoid main() {\n\t  vUv = vec2(uv);\n\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t}\n"},function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i.d(t,"b",function(){return a});var n="\n\t// this is the texture position the data for this particle is stored in\n\tvarying vec2 vUv;\n\n\tuniform sampler2D tWebcam;\n\n\tuniform float sizeInc;\n  uniform float sizeRange;\n  uniform float webcamWidth;\n\tuniform float webcamHeight;\n\n\tvoid main() {\n\t\tvec3 webcamParticle = texture2D(tWebcam, vUv).xyz;\n\t\tvec3 webcamParticleAbove = texture2D(tWebcam, vec2(vUv.x, vUv.y - (1.0 / webcamWidth))).xyz;\n\t\tvec3 webcamParticleBelow = texture2D(tWebcam, vec2(vUv.x, vUv.y + (1.0 / webcamWidth))).xyz;\n\t\tvec3 webcamParticleLeft = texture2D(tWebcam, vec2(vUv.x - (1.0 / webcamHeight), vUv.y)).xyz;\n\t\tvec3 webcamParticleRight = texture2D(tWebcam, vec2(vUv.x + (1.0 / webcamHeight), vUv.y)).xyz;\n\n    float average = (\n\t\t\twebcamParticleAbove.r +\n      webcamParticleBelow.r +\n      webcamParticleLeft.r +\n\t\t\twebcamParticleRight.r\n\t\t) / 4.0;\n\n    webcamParticle.x -= average;\n    webcamParticle.y -= average;\n    webcamParticle.z -= average;\n\n\t\tgl_FragColor = vec4(webcamParticle, 1.0);\n\t}\n",a="\n\t// this value stores the texture coordinates the data for this vertex is stored in\n\tvarying vec2 vUv;\n\n\tvoid main() {\n\t  vUv = uv;\n\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t}\n"},function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i.d(t,"b",function(){return a});var n="\n\tuniform sampler2D tColour;\n\tuniform bool isCircle;\n\n\tvarying vec2 vUv;\n\n\tvoid main() {\n\t\tvec4 colour = texture2D(tColour, vUv).rgba;\n\n\t\tgl_FragColor = colour;\n\n\t\tif (isCircle) {\n\t\t\tif (length(gl_PointCoord - vec2(0.5, 0.5)) > 0.475) discard; // makes particles a circle\n\t\t}\n\t}\n",a="\n\tuniform sampler2D tPosition;\n\tuniform sampler2D tSize;\n\n\tuniform float sizeMultiplierForScreen;\n\n\tvarying vec2 vUv;\n\n\tvoid main() {\n\t\tvUv = position.xy;\n\n\t\tvec3 position = texture2D(tSize, vUv).xyz;\n\t\tfloat size = texture2D(tSize, vUv).w;\n\n\t\tvec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n\t\tgl_PointSize = size * (sizeMultiplierForScreen / -mvPosition.z);\n\t\tgl_Position = projectionMatrix * mvPosition;\n\t}\n"},function(e,t,i){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=function(){function t(n){var a=n.alpha,o=void 0===a||a,r=n.pixelRatio,s=void 0===r?window.devicePixelRatio:r,u=n.width,l=void 0===u?window.innerWidth:u,c=n.height,d=void 0===c?window.innerHeight:c,h=n.container;i(this,t),this.renderer=new e.WebGLRenderer({alpha:o});var v=this.renderer.context;v.enable(v.BLEND),v.blendFunc(v.SRC_ALPHA,v.ONE_MINUS_SRC_ALPHA),this.setPixelRatio(s),this.setSize(l,d),h.appendChild(this.getDomElement()),window.addEventListener("resize",this.onWindowResize.bind(this))}return n(t,[{key:"getDomElement",value:function(){return this.renderer.domElement}},{key:"onWindowResize",value:function(){var e=window.innerWidth,t=window.innerHeight;this.renderer.setSize(e,t)}},{key:"setPixelRatio",value:function(e){this.renderer.setPixelRatio(e)}},{key:"setSize",value:function(e,t){this.renderer.setSize(e,t)}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scene,i=e.camera,n=e.renderTarget,a=void 0===n?null:n,o=e.force,r=void 0!==o&&o;this.renderer.render(t,i,a,r)}},{key:"get",value:function(){return this.renderer}}]),t}();t.a=a}).call(t,i(0))},function(e,t,i){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=function(){function t(){i(this,t),this.scene=new e.Scene}return n(t,[{key:"add",value:function(e){this.scene.add(e)}},{key:"remove",value:function(e){this.scene.remove(e)}},{key:"get",value:function(){return this.scene}}]),t}();t.a=a}).call(t,i(0))}],[6]);
//# sourceMappingURL=bundle.js.map